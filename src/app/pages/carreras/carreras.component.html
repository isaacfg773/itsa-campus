<section class="section">
  <div class="container">
    <h1 class="page-title">Oferta Acad√©mica</h1>
    <p class="lead center">
      Programas t√©cnicos con alta empleabilidad, pr√°ctica real y convenios.
    </p>

    <!-- CONTROLES -->
    <div class="toolbar">
      <input
        type="search"
        [(ngModel)]="q"
        class="input"
        placeholder="Buscar carrera (ej. Sistemas, Administraci√≥n, Topograf√≠a)‚Ä¶" />

      <div class="chips">
        <button class="chip" [class.active]="filtroTurno==='Todos'" (click)="setTurno('Todos')">Todos</button>
        <button class="chip" [class.active]="filtroTurno==='Ma√±ana'" (click)="setTurno('Ma√±ana')">Ma√±ana</button>
        <button class="chip" [class.active]="filtroTurno==='Noche'" (click)="setTurno('Noche')">Noche</button>
      </div>
    </div>

    <!-- GRID DE CARRERAS -->
    <div class="grid">
      <article class="card carrera" *ngFor="let c of listaFiltrada">
        <div class="thumb" [ngStyle]="{'background-image': 'url(' + (c.imagen || '/carreras/default.jpg') + ')'}">
          <span class="badge">{{ c.duracion }}</span>
        </div>

        <div class="body">
          <h3 class="title">{{ c.titulo }}</h3>
          <p class="desc">{{ c.desc }}</p>

          <div class="meta">
            <span class="pill" [class.pill--green]="c.turno==='Ma√±ana'">Turno: {{ c.turno }}</span>
          </div>

          <div class="actions">
            <!-- üëâ Cambiado: ahora abre el modal -->
            <button class="btn btn--outline" type="button" (click)="onVerMalla($event, c)">Ver malla</button>
            <a class="btn btn--green"
               href="https://api.whatsapp.com/send?phone=59176433612"
               target="_blank"
               rel="noopener">
              Inscribirme
            </a>
          </div>
        </div>
      </article>
    </div>

    <!-- MENSAJE VAC√çO -->
    <div *ngIf="!listaFiltrada.length" class="empty panel">
      <p>Sin resultados para ‚Äú{{ q }}‚Äù. Prueba otra palabra o quita filtros.</p>
    </div>
  </div>
</section>

<!-- ========================== -->
<!-- MODAL DE MALLA CURRICULAR -->
<!-- ========================== -->
<div class="malla-modal" *ngIf="modalOpen" (click)="closeMalla()">
  <div class="malla-modal__inner" (click)="$event.stopPropagation()">
    <button class="malla-modal__close" (click)="closeMalla()">‚úï</button>
    <h3 class="malla-modal__title">{{ modalTitle }}</h3>
    <img class="malla-modal__img" [src]="modalSrc!" alt="Malla curricular" />
  </div>
</div>
